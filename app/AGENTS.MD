# AGENTS.md - Working in `app/`

## Quick Rules

- `app/styled-system/` is generated by Panda. Do not edit by hand.
- Dependency installs are user-run by default: run `pnpm i` yourself when dependencies change or a package is added/updated.
- Assume sandboxed installs may fail; treat local user install as the reliable path.
- Reads: `query()` + `createResource()`.
- For `createResource`, prefer `resource.latest` for steady UI during revalidation.
- Use `resource()` directly only when you intentionally need loading/pending-state transitions.
- Writes: server actions.
- Avoid `fetch()` in UI components for app data.
- Prefer `~/components/ui/*` wrappers over ad-hoc route-local composition.
- Keep reusable UI out of `app/src/routes/`.

## Commands

Run inside `app/`:

- `pnpm install`
- `pnpm prepare`
- `pnpm dev`
- `pnpm lint`
- `pnpm lint:fix`
- `pnpm type-check`
- `pnpm test`
- `pnpm build`
- `pnpm start`

## Key Paths

- App entry: `app/src/app.tsx`
- Shared UI wrappers: `app/src/components/ui/`
- Theme + recipes: `app/src/theme/`
- Panda config: `app/panda.config.ts`

## UI Conventions

- Prefer simplified shared wrappers when they fit:
  - `SimpleDialog`
  - `SimplePopover`
  - `SimpleSelect`
  - `PanelPopover`
  - `ConfirmDialog`
- Use `ClearButton` and `CloseButton` for icon-only clear/close actions.
- Keep SSR + hydration output stable for overlay controls.
- Use Panda tokens and recipes; avoid hard-coded spacing/colors unless a token is missing.

## Available Feature Modules

- Console log capture/viewer is available at `app/src/components/console-log-capture/`.
  - App-level entry: `ConsoleLogCaptureProvider.tsx` (self-managed open state + `Cmd/Ctrl+P` shortcut).
  - Panel entry: `ConsoleLogCapturePanel.tsx`
  - In-module store: `consoleLogCapture.store.ts`
  - Keep related UI/state/utils in this single module folder.
- Markdown rendering stack is available at `app/src/components/markdown-renderer/`.
  - Main entry: `MarkdownRenderer.tsx`
  - Shared exports: `index.ts`
  - Keep markdown rendering, highlighting, and mermaid helpers co-located in this module folder.

## Data + SSR Safety

- Keep server-only logic on the server.
- Keep component render trees deterministic between server and first client render.
- For wrappers, ensure external props are forwarded to the actual rendered slot.
