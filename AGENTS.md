# AGENTS.md - SolidStart Panda Park Starter

Repository-level guidance for contributors and coding agents.

## Quick Rules

- `app/styled-system/` is generated by Panda. Do not edit it by hand.
- Use `pnpm` for package/scripts commands; use `pnpm dlx` for one-off CLIs.
- Prefer SolidStart data APIs (`query` + `createResource` for reads, server actions for writes).
- For `createResource`, prefer reading `resource.latest` by default to avoid transient empty/loading blips during revalidation.
- Use `resource()` directly only when you intentionally want a pending/loading transition in the UI.
- Prefer `~/components/ui/*` wrappers over route-level direct Ark composition.
- Prefer ParkUI wrappers for interactive controls over native elements when a wrapper exists.
- Use `~/components/ui/tooltip` for user-facing hover/focus help text; avoid `title` attributes.
- Ark Solid `asChild` callback props are getter functions. Spread `...props()` in wrapper callbacks.
- Keep reusable UI out of `app/src/routes/`; put shared code in `app/src/components/*`.
- Prefer tokenized Panda styles over one-off CSS values.
- Prefer explicit labels for form inputs; avoid placeholder-only labeling unless tightly constrained.

## Repo Structure

- App code: `app/src/*`
- Shared UI wrappers: `app/src/components/ui/*`
- Theme/tokens/recipes: `app/src/theme/*`
- Generated styles/types: `app/styled-system/*`
- Local reusable agent skills: `.agents/skills/*`

## Development Commands

Run from `app/` (or use `pnpm -C app <cmd>`):

- `pnpm install`
- `pnpm prepare`
- `pnpm dev`
- `pnpm type-check`
- `pnpm test`
- `pnpm build`

## Skills In This Repo

Local skills imported from the visual-notes workflow are available under `.agents/skills/`:

- `color-palette-check-and-add`
- `component-structure-minimal-dom`
- `post-work-doc-playbook`
- `solid-props-state-patterns`
- `solid-reactivity-control-flow`
- `solid-structure-types-quality`
- `solid-ui-composition-patterns`
- `solidstart-data-async`
- `tiptap-codeblock-stability-playbook`
- `tiptap-nodeview-migration-playbook`
- `toc-rail-layout-playbook`

Use these when the task matches the skill intent. Open each skill's `SKILL.md` before applying it.

## UI Wrapper Guidance

- For reusable overlays, prefer the simplified wrappers first:
  - `SimpleDialog`
  - `SimplePopover`
  - `SimpleSelect`
  - `PanelPopover`
  - `ConfirmDialog`
- Use `ClearButton` and `CloseButton` for consistent icon-only action affordances.
- For Ark Solid wrappers that use `asChild`, invoke callback props getters (`asChild={(props) => <el {...props()} />}`).
- Use the shared `Tooltip` wrapper for hover/focus help content; avoid native `title` behavior.
- Keep SSR and first client render structure stable for overlay-heavy controls.
- Forward wrapper props to the rendered slot that actually owns DOM/styling.

## Color Palette Workflow

- Before using a new palette token, confirm it exists in `app/panda.config.ts` semantic tokens and `app/src/theme/colors/`.
- If a palette is missing, add it with Park UI CLI: `pnpm dlx @park-ui/cli add <palette>`.
- After adding/updating palette tokens:
  - `pnpm -C app panda codegen`
  - `pnpm -C app type-check`

## Tooling Boosts

- Root `.mcp.json` includes Ark UI MCP server wiring for component-aware assistance.
- `app/vitest.config.ts` provides baseline testing config and `~` alias resolution.
